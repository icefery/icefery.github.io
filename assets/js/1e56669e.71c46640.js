"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3324],{3905:(e,n,a)=>{a.d(n,{Zo:()=>u,kt:()=>d});var t=a(7294);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=t.createContext({}),p=function(e){var n=t.useContext(s),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},u=function(e){var n=p(e.components);return t.createElement(s.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},k=t.forwardRef((function(e,n){var a=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),k=l,d=c["".concat(s,".").concat(k)]||c[k]||m[k]||r;return a?t.createElement(d,i(i({ref:n},u),{},{components:a})):t.createElement(d,i({ref:n},u))}));function d(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=a.length,i=new Array(r);i[0]=k;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o[c]="string"==typeof e?e:l,i[1]=o;for(var p=2;p<r;p++)i[p]=a[p];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}k.displayName="MDXCreateElement"},8831:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var t=a(7462),l=(a(7294),a(3905));const r={},i=void 0,o={unversionedId:"big-data/flume/Flume \u7b14\u8bb0",id:"big-data/flume/Flume \u7b14\u8bb0",title:"Flume \u7b14\u8bb0",description:"\u4e00\u3001Flume \u6982\u8ff0",source:"@site/docs/big-data/flume/Flume \u7b14\u8bb0.md",sourceDirName:"big-data/flume",slug:"/big-data/flume/Flume \u7b14\u8bb0",permalink:"/docs/big-data/flume/Flume \u7b14\u8bb0",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Flume",permalink:"/docs/big-data/flume/"},next:{title:"Greenplum",permalink:"/docs/big-data/greenplum/"}},s={},p=[{value:"\u4e00\u3001Flume \u6982\u8ff0",id:"\u4e00flume-\u6982\u8ff0",level:2},{value:"1.1 Flume \u5b9a\u4e49",id:"11-flume-\u5b9a\u4e49",level:3},{value:"1.2 Flume \u57fa\u7840\u67b6\u6784",id:"12-flume-\u57fa\u7840\u67b6\u6784",level:3},{value:"Agent",id:"agent",level:4},{value:"Source",id:"source",level:4},{value:"Sink",id:"sink",level:4},{value:"Channel",id:"channel",level:4},{value:"Event",id:"event",level:4},{value:"\u4e8c\u3001Flume \u5165\u95e8",id:"\u4e8cflume-\u5165\u95e8",level:2},{value:"2.1 Flume \u5b89\u88c5\u90e8\u7f72",id:"21-flume-\u5b89\u88c5\u90e8\u7f72",level:3},{value:"2.2 Flume \u5165\u95e8\u6848\u4f8b",id:"22-flume-\u5165\u95e8\u6848\u4f8b",level:3},{value:"2.2.1 \u76d1\u63a7\u7aef\u53e3\u6570\u636e\u5b98\u65b9\u6848\u4f8b",id:"221-\u76d1\u63a7\u7aef\u53e3\u6570\u636e\u5b98\u65b9\u6848\u4f8b",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4",level:5},{value:"2.2.2 \u5b9e\u65f6\u76d1\u63a7\u5355\u4e2a\u8ffd\u52a0\u6587\u4ef6",id:"222-\u5b9e\u65f6\u76d1\u63a7\u5355\u4e2a\u8ffd\u52a0\u6587\u4ef6",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-1",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-1",level:5},{value:"2.2.3 \u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u65b0\u6587\u4ef6",id:"223-\u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u65b0\u6587\u4ef6",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-2",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-2",level:5},{value:"\u8bf4\u660e",id:"\u8bf4\u660e",level:5},{value:"2.2.4 \u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u8ffd\u52a0\u6587\u4ef6",id:"224-\u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u8ffd\u52a0\u6587\u4ef6",level:4},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd",level:5},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-3",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-3",level:5},{value:"\u8bf4\u660e",id:"\u8bf4\u660e-1",level:5},{value:"\u4e09\u3001Flume \u8fdb\u9636",id:"\u4e09flume-\u8fdb\u9636",level:2},{value:"3.1 Flume \u4e8b\u52a1",id:"31-flume-\u4e8b\u52a1",level:3},{value:"3.2 Flume Agent \u5185\u90e8\u539f\u7406",id:"32-flume-agent-\u5185\u90e8\u539f\u7406",level:3},{value:"ChannelSelector",id:"channelselector",level:4},{value:"SinkProcessor",id:"sinkprocessor",level:4},{value:"3.3 Flume \u62d3\u6251\u7ed3\u6784",id:"33-flume-\u62d3\u6251\u7ed3\u6784",level:3},{value:"\u7b80\u5355\u4e32\u8054",id:"\u7b80\u5355\u4e32\u8054",level:4},{value:"\u590d\u5236\u548c\u591a\u8def\u590d\u7528",id:"\u590d\u5236\u548c\u591a\u8def\u590d\u7528",level:4},{value:"\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb",id:"\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb",level:4},{value:"\u805a\u5408",id:"\u805a\u5408",level:4},{value:"3.4 Flume \u5f00\u53d1\u6848\u4f8b",id:"34-flume-\u5f00\u53d1\u6848\u4f8b",level:3},{value:"3.4.1 \u590d\u5236\u548c\u591a\u8def\u590d\u7528",id:"341-\u590d\u5236\u548c\u591a\u8def\u590d\u7528",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-4",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-4",level:5},{value:"3.4.2 \u8d1f\u8d23\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb",id:"342-\u8d1f\u8d23\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-5",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-5",level:5},{value:"3.4.3 \u805a\u5408",id:"343-\u805a\u5408",level:4},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-6",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-6",level:5},{value:"3.5 \u81ea\u5b9a\u4e49 Interceptor",id:"35-\u81ea\u5b9a\u4e49-interceptor",level:3},{value:"\u6848\u4f8b\u9700\u6c42",id:"\u6848\u4f8b\u9700\u6c42-7",level:5},{value:"\u9700\u6c42\u5206\u6790",id:"\u9700\u6c42\u5206\u6790",level:5},{value:"\u5b9e\u73b0\u6b65\u9aa4",id:"\u5b9e\u73b0\u6b65\u9aa4-7",level:5},{value:"3.6 \u81ea\u5b9a\u4e49 Source",id:"36-\u81ea\u5b9a\u4e49-source",level:3},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd-1",level:5},{value:"\u9700\u6c42",id:"\u9700\u6c42",level:5},{value:"\u7f16\u7801",id:"\u7f16\u7801",level:5},{value:"3.7 \u81ea\u5b9a\u4e49 Sink",id:"37-\u81ea\u5b9a\u4e49-sink",level:3},{value:"\u4ecb\u7ecd",id:"\u4ecb\u7ecd-2",level:5},{value:"\u9700\u6c42",id:"\u9700\u6c42-1",level:5},{value:"\u7f16\u7801",id:"\u7f16\u7801-1",level:5},{value:"\u56db\u3001\u9762\u8bd5\u9898",id:"\u56db\u9762\u8bd5\u9898",level:2},{value:"4.1 \u4f60\u662f\u5982\u4f55\u5b9e\u73b0 Flume \u6570\u636e\u4f20\u8f93\u7684\u76d1\u63a7\u7684\uff1f",id:"41-\u4f60\u662f\u5982\u4f55\u5b9e\u73b0-flume-\u6570\u636e\u4f20\u8f93\u7684\u76d1\u63a7\u7684",level:3},{value:"4.2 Flume \u7684 Source\u3001Sink\u3001Channel \u7684\u4f5c\u7528\uff1f\u4f60\u4eec Source \u662f\u4ec0\u4e48\u7c7b\u578b\uff1f",id:"42-flume-\u7684-sourcesinkchannel-\u7684\u4f5c\u7528\u4f60\u4eec-source-\u662f\u4ec0\u4e48\u7c7b\u578b",level:3},{value:"\u4f5c\u7528",id:"\u4f5c\u7528",level:4},{value:"Source \u7c7b\u578b",id:"source-\u7c7b\u578b",level:4},{value:"4.3 Flume \u7684 Channel Selectors",id:"43-flume-\u7684-channel-selectors",level:3},{value:"4.4 Flume \u53c2\u6570\u8c03\u4f18",id:"44-flume-\u53c2\u6570\u8c03\u4f18",level:3},{value:"Source",id:"source-1",level:4},{value:"Channel",id:"channel-1",level:4},{value:"Sink",id:"sink-1",level:4},{value:"4.5 Flume \u7684\u4e8b\u52a1\u673a\u5236",id:"45-flume-\u7684\u4e8b\u52a1\u673a\u5236",level:3},{value:"4.6 Flume \u91c7\u96c6\u6570\u636e\u4f1a\u4e22\u5931\u5417\uff1f",id:"46-flume-\u91c7\u96c6\u6570\u636e\u4f1a\u4e22\u5931\u5417",level:3}],u={toc:p};function c(e){let{components:n,...a}=e;return(0,l.kt)("wrapper",(0,t.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"\u4e00flume-\u6982\u8ff0"},"\u4e00\u3001Flume \u6982\u8ff0"),(0,l.kt)("h3",{id:"11-flume-\u5b9a\u4e49"},"1.1 Flume \u5b9a\u4e49"),(0,l.kt)("p",null,"Flume \u662f Cloudera \u63d0\u4f9b\u7684\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\uff0c\u9ad8\u53ef\u9760\u7684\uff0c\u5206\u5e03\u5f0f\u7684\u6d77\u91cf\u65e5\u5fd7\u91c7\u96c6\u3001\u805a\u5408\u548c\u4f20\u8f93\u7684\u7cfb\u7edf\u3002Flume \u57fa\u4e8e\u6d41\u5f0f\u67b6\u6784\uff0c\u7075\u6d3b\u7b80\u5355\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/bc00bad4c162417a84a2b349dee8d1db.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"12-flume-\u57fa\u7840\u67b6\u6784"},"1.2 Flume \u57fa\u7840\u67b6\u6784"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/img_convert/9ca390ddd2dfdcf4f09001e910026c58.png",alt:null})),(0,l.kt)("h4",{id:"agent"},"Agent"),(0,l.kt)("p",null,"Agent \u662f\u4e00\u4e2a JVM \u8fdb\u7a0b\uff0c\u5b83\u4ee5\u4e8b\u4ef6\u7684\u5f62\u5f0f\u5c06\u6570\u636e\u4ece\u6e90\u5934\u4f20\u9001\u81f3\u76ee\u7684\u5730\u3002"),(0,l.kt)("p",null,"Agent \u4e3b\u8981\u7531\u4e09\u4e2a\u90e8\u5206\u7ec4\u6210\uff1aSource\u3001Channel\u3001Sink\u3002"),(0,l.kt)("h4",{id:"source"},"Source"),(0,l.kt)("p",null,"Source \u662f\u8d1f\u8d23\u63a5\u6536\u6570\u636e\u5230 Flume Agent \u7684\u7ec4\u4ef6\u3002Source \u7ec4\u4ef6\u53ef\u4ee5\u5904\u7406\u5404\u79cd\u7c7b\u578b\u3001\u5404\u79cd\u683c\u5f0f\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u5305\u62ec avro\u3001thrift\u3001exec\u3001jms\u3001spooling directory\u3001netcat\u3001taildir\u3001sequence generator\u3001syslog\u3001http\u3001legacy\u3002"),(0,l.kt)("h4",{id:"sink"},"Sink"),(0,l.kt)("p",null,"Sink \u4e0d\u65ad\u7b2c\u8f6e\u8be2 Channel \u4e2d\u7684\u4e8b\u4ef6\u4e14\u6279\u91cf\u5730\u79fb\u9664\u5b83\u4eec\uff0c\u5e76\u5c06\u8fd9\u4e9b\u4e8b\u4ef6\u6279\u91cf\u5199\u5165\u5230\u5b58\u50a8\u6216\u7d22\u5f15\u7cfb\u7edf\u3002\u6216\u8005\u88ab\u53d1\u9001\u5230\u53e6\u4e00\u4e2a Flume Agent\u3002"),(0,l.kt)("p",null,"Sink \u7ec4\u4ef6\u76ee\u7684\u5730\u5305\u62ec hdfs\u3001logger\u3001avro\u3001thrift\u3001ipc\u3001file\u3001hbase\u3001solr\u3001\u81ea\u5b9a\u4e49\u3002"),(0,l.kt)("h4",{id:"channel"},"Channel"),(0,l.kt)("p",null,"Channel \u662f\u4f4d\u4e8e Source \u548c Sink \u4e4b\u95f4\u7684\u7f13\u51b2\u533a\u3002\u56e0\u6b64 Channel \u5141\u8bb8 Source \u548c Sink \u8fd0\u4f5c\u5728\u4e0d\u540c\u7684\u901f\u7387\u4e0a\u3002Channel \u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u51e0\u4e2a Source \u7684\u5199\u5165\u64cd\u4f5c\u548c\u51e0\u4e2a Sink \u7684\u8bfb\u53d6\u64cd\u4f5c\u3002"),(0,l.kt)("p",null,"Flume \u81ea\u5e26\u4e24\u79cd Channel\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Memory Channel"),(0,l.kt)("p",{parentName:"li"},"Memory Channel \u662f\u5185\u5b58\u4e2d\u7684\u961f\u5217\u3002Memory Channel \u5728\u4e0d\u9700\u8981\u5173\u7cfb\u6570\u636e\u4e22\u5931\u7684\u60c5\u666f\u4e0b\u9002\u7528\u3002\u5982\u679c\u9700\u8981\u5173\u7cfb\u6570\u636e\u4e22\u5931\uff0c\u90a3\u4e48 Memory Channel \u5c31\u4e0d\u5e94\u8be5\u9002\u7528\uff0c\u56e0\u4e3a\u7a0b\u5e8f\u6b7b\u4ea1\u3001\u53ca\u5176\u5b95\u673a\u6216\u8005\u91cd\u542f\u90fd\u4f1a\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"File Channel"),(0,l.kt)("p",{parentName:"li"},"File Channel \u5c06\u6240\u6709\u4e8b\u4ef6\u5199\u5230\u78c1\u76d8\u3002\u56e0\u6b64\u5728\u7a0b\u5e8f\u5173\u95ed\u6216\u673a\u5668\u5b95\u673a\u7684\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u4e22\u5931\u6570\u636e\u3002"))),(0,l.kt)("h4",{id:"event"},"Event"),(0,l.kt)("p",null,"Flume \u6570\u636e\u4f20\u8f93\u7684\u57fa\u672c\u5355\u5143\uff0c\u4ee5 Event \u7684\u5f62\u5f0f\u5c06\u6570\u636e\u4ece\u6e90\u5934\u9001\u81f3\u76ee\u7684\u5730\u3002Event \u7531 Header \u548c Body \u4e24\u90e8\u5206\u7ec4\u6210\uff0cHeader \u7528\u6765\u5b58\u653e\u8be5 Event \u7684\u4e00\u4e9b\u5c5e\u6027\uff0c\u4e3a K-V \u7ed3\u6784\uff0cBody \u7528\u6765\u5b58\u653e\u8be5\u6761\u6570\u636e\uff0c\u5f62\u5f0f\u4e3a\u5b57\u8282\u6570\u7ec4\u3002"),(0,l.kt)("br",null),(0,l.kt)("br",null),(0,l.kt)("h2",{id:"\u4e8cflume-\u5165\u95e8"},"\u4e8c\u3001Flume \u5165\u95e8"),(0,l.kt)("h3",{id:"21-flume-\u5b89\u88c5\u90e8\u7f72"},"2.1 Flume \u5b89\u88c5\u90e8\u7f72"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u4e0b\u8f7d\u89e3\u538b"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"tar -zxvf apache-flume-1.9.0-bin.tar.gz -C /opt\nmv /opt/apache-flume-1.9.0-bin.tar.gz /opt/flume\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u914d\u7f6e\u73af\u5883\u53d8\u91cf"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo 'export FLUME_HOME=/opt/flume' >> /etc/bash.profile\nsource /etc/profile\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u517c\u5bb9 Guava \u4f9d\u8d56"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"rm $(find $FLUME_HOME/lib -name 'guava-*')\ncp $(find $HADOOP_HOME/share/hadoop/common/lib -name 'guava-*' | head -n 1) $FLUME_HOME/lib\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u517c\u5bb9 SLF4J \u4f9d\u8d56"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"rm $(find $FLUME_HOME/lib -name 'slf4j-*')\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8c03\u6574\u5185\u5b58"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd $FLUME_HOME\n\ncp conf/flume-env.sh.template conf/flume-env.sh\n\nvim conf/flume-env.sh\n")),(0,l.kt)("p",{parentName:"li"},"\u4fee\u6539\u76f8\u5e94\u6ce8\u91ca\u884c\u4e3a\uff1a"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'export JAVA_OPTS="-Xms1024m -Xmx1024m -Dcom.sun.management.jmxremote"\n')))),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"22-flume-\u5165\u95e8\u6848\u4f8b"},"2.2 Flume \u5165\u95e8\u6848\u4f8b"),(0,l.kt)("h4",{id:"221-\u76d1\u63a7\u7aef\u53e3\u6570\u636e\u5b98\u65b9\u6848\u4f8b"},"2.2.1 \u76d1\u63a7\u7aef\u53e3\u6570\u636e\u5b98\u65b9\u6848\u4f8b"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u76d1\u542c\u4e00\u4e2a\u7aef\u53e3\uff0c\u6536\u96c6\u8be5\u7aef\u53e3\u6570\u636e\uff0c\u5e76\u6253\u5370\u5230\u63a7\u5236\u53f0\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u68c0\u67e5 44444 \u7aef\u53e3\u662f\u5426\u88ab\u5360\u7528"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"netstat -nlp | grep 44444\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume-netcat-logger.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"cd $FLUME_HOME\n\nmkdir -p jobs\n\nvim jobs/flume-netcat-logger.conf\n")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# NetCat TCP Source\na1.sources.r1.channels = c1\na1.sources.r1.type = netcat\na1.sources.r1.bind=localhost\na1.sources.r1.port = 44444\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent                          \\\n  --conf conf/                              \\\n  --conf-file jobs/flume-netcat-logger.conf \\\n  --name a1                                 \\\n  -Dflume.root.logger=INFO,console\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5411\u672c\u673a 44444 \u7aef\u53e3\u53d1\u9001\u6570\u636e"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"nc localhost 44444\n")))),(0,l.kt)("h4",{id:"222-\u5b9e\u65f6\u76d1\u63a7\u5355\u4e2a\u8ffd\u52a0\u6587\u4ef6"},"2.2.2 \u5b9e\u65f6\u76d1\u63a7\u5355\u4e2a\u8ffd\u52a0\u6587\u4ef6"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-1"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u5b9e\u65f6\u76d1\u63a7 ",(0,l.kt)("inlineCode",{parentName:"p"},"/opt/flume/input/a.txt")," \u6587\u4ef6\uff0c\u5e76\u4e0a\u4f20\u81f3 HDFS\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-1"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume-file-hdfs.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Exec Source\na1.sources.r1.channels = c1\na1.sources.r1.type = exec\na1.sources.r1.command = tail -F /opt/flume/input/a.txt\na1.sources.r1.shell = /bin/bash -c\n\n# HDFS Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = hdfs://node6:9000/flume/%Y-%m-%d/%H\na1.sinks.k1.hdfs.round = true\na1.sinks.k1.hdfs.fileType = DataStream\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent -c conf/ -f jobs/flume-file-hdfs.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8ffd\u52a0\u6587\u4ef6"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p /opt/flume/input\necho $RANDOM >> /opt/flume/input/a.txt\n")))),(0,l.kt)("h4",{id:"223-\u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u65b0\u6587\u4ef6"},"2.2.3 \u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u65b0\u6587\u4ef6"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-2"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u76d1\u542c ",(0,l.kt)("inlineCode",{parentName:"p"},"/opt/flume/input"),"\u6574\u4e2a\u76ee\u5f55\u7684\u6587\u4ef6\uff0c\u5e76\u4e0a\u4f20\u81f3 HDFS\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-2"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume-dir-hdfs.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"a1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Spooling Directory Source\na1.sources.r1.channels = c1\na1.sources.r1.type = spooldir\na1.sources.r1.spoolDir = /opt/flume/input\na1.sources.r1.fileHeader = true\n\n# HDFS Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = hdfs://node6:9000/flume/%Y-%m-%d/%H\na1.sinks.k1.hdfs.round = true\na1.sinks.k1.hdfs.fileType = DataStream\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent -c conf/ -f jobs/flume-dir-hdfs.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u65b0\u5efa\u6587\u4ef6"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"touch /opt/flume/input/1.txt\ntouch /opt/flume/input/2.txt\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u67e5\u770b\u76ee\u5f55\u53d8\u5316"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"watch ls /opt/flume/input\n")))),(0,l.kt)("h5",{id:"\u8bf4\u660e"},"\u8bf4\u660e"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"spoolDir")," \u4e0d\u652f\u6301 ",(0,l.kt)("inlineCode",{parentName:"p"},"~")," \u8def\u5f84\u3002\u6bd4\u5982 ",(0,l.kt)("inlineCode",{parentName:"p"},"~/input")," \u4f1a\u62a5\u9519\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"java.lang.IllegalStateException: Directory does not exist: /opt/flume/~/input\n")),(0,l.kt)("p",null,"\u5728\u4f7f\u7528 Spooling Directory Source \u65f6\uff1a"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u4e0d\u8981\u518d\u76d1\u63a7\u76ee\u5f55\u4e2d\u521b\u5efa\u5e76\u6301\u7eed\u4fee\u6539\u6587\u4ef6"),(0,l.kt)("li",{parentName:"ol"},"\u4e0a\u4f20\u5b8c\u6210\u7684\u6587\u4ef6\u4f1a\u4ee5 ",(0,l.kt)("inlineCode",{parentName:"li"},".COMPLETED")," \u7ed3\u5c3e"),(0,l.kt)("li",{parentName:"ol"},"\u88ab\u76d1\u63a7\u6587\u4ef6\u5939\u6bcf 500 \u6beb\u79d2\u626b\u63cf\u4e00\u6b21\u6587\u4ef6\u53d8\u52a8")),(0,l.kt)("h4",{id:"224-\u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u8ffd\u52a0\u6587\u4ef6"},"2.2.4 \u5b9e\u65f6\u76d1\u63a7\u76ee\u5f55\u4e0b\u7684\u591a\u4e2a\u8ffd\u52a0\u6587\u4ef6"),(0,l.kt)("h5",{id:"\u4ecb\u7ecd"},"\u4ecb\u7ecd"),(0,l.kt)("p",null,"Exec Source \u9002\u7528\u4e8e\u76d1\u63a7\u4e00\u4e2a\u5b9e\u65f6\u8ffd\u52a0\u7684\u6587\u4ef6\uff0c\u4e0d\u80fd\u5b9e\u73b0\u65ad\u70b9\u7eed\u4f20\uff1bSpooling Directory Source \u9002\u7528\u4e8e\u540c\u6b65\u65b0\u6587\u4ef6\uff0c\u4f46\u4e0d\u9002\u5408\u5bf9\u5b9e\u65f6\u8ffd\u52a0\u65e5\u5fd7\u7684\u6587\u4ef6\u8fdb\u884c\u76d1\u542c\u5e76\u540c\u6b65\uff1b\u800c Taildir Source \u9002\u5408\u7528\u4e8e\u76d1\u542c\u591a\u4e2a\u5b9e\u65f6\u8ffd\u52a0\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u80fd\u591f\u5b9e\u73b0\u65ad\u70b9\u7eed\u4f20\u3002"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-3"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u76d1\u542c\u6574\u4e2a\u76ee\u5f55\u7684\u5b9e\u65f6\u8ffd\u52a0\u6587\u4ef6\uff0c\u5e76\u4e0a\u4f20\u81f3 HDFS\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-3"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume-taildir-hdfs.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Taildir Source\na1.sources.r1.channels = c1\na1.sources.r1.type = TAILDIR\na1.sources.r1.filegroups = f1\na1.sources.r1.filegroups.f1 = /opt/flume/input/.*txt.*\na1.sources.r1.positionFile = /opt/flume/taildir_position.json\na1.sources.r1.fileHeader = true\n\n# HDFS Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = hdfs://node6:9000/flume/%Y-%m-%d/%H\na1.sinks.k1.hdfs.round = true\na1.sinks.k1.hdfs.fileType = DataStream\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent -c conf/ -f jobs/flume-taildir-hdfs.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8ffd\u52a0\u6587\u4ef6"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo $RANDOM >> /opt/flume/input/a.txt\necho $RANDOM >> /opt/flume/input/b.txt\n")))),(0,l.kt)("h5",{id:"\u8bf4\u660e-1"},"\u8bf4\u660e"),(0,l.kt)("p",null,"Taildir Source \u7ef4\u62a4\u4e86\u4e00\u4e2a JSON \u683c\u5f0f\u7684 Position File\uff0c\u4f1a\u5b9a\u671f\u7684\u5f80 Position File \u4e2d\u66f4\u65b0\u6bcf\u4e2a\u6587\u4ef6\u8bfb\u53d6\u5230\u7684\u6700\u65b0\u7684\u4f4d\u7f6e\uff0c\u56e0\u6b64\u80fd\u591f\u5b9e\u73b0\u65ad\u70b9\u7eed\u4f20\u3002Position File \u683c\u5f0f\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json"},'[\n  { "inode": 1579598, "pos": 12, "file": "/opt/flume/input/a.txt" },\n  { "inode": 1579593, "pos": 6, "file": "/opt/flume/input/b.txt" }\n]\n')),(0,l.kt)("p",null,"Linux \u4e2d\u5b58\u50a8\u6587\u4ef6\u5143\u6570\u636e\u533a\u57df\u53eb\u505a inode\uff0c\u6bcf\u4e2a inode \u90fd\u6709\u4e00\u4e2a\u53f7\u7801\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7528 inode \u53f7\u7801\u8bc6\u522b\u4e0d\u540c\u7684\u6587\u4ef6\uff0cUnix/Linux \u7cfb\u7edf\u5185\u90e8\u4e0d\u4f7f\u7528\u6587\u4ef6\u540d\uff0c\u800c\u4f7f\u7528 inode \u53f7\u7801\u6765\u8bc6\u522b\u6587\u4ef6\u3002"),(0,l.kt)("br",null),(0,l.kt)("br",null),(0,l.kt)("h2",{id:"\u4e09flume-\u8fdb\u9636"},"\u4e09\u3001Flume \u8fdb\u9636"),(0,l.kt)("h3",{id:"31-flume-\u4e8b\u52a1"},"3.1 Flume \u4e8b\u52a1"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/702e4aaad9874d1fa59ea010106bee00.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"32-flume-agent-\u5185\u90e8\u539f\u7406"},"3.2 Flume Agent \u5185\u90e8\u539f\u7406"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/22286d7942f34048a5a2d15cc7908b8f.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,l.kt)("h4",{id:"channelselector"},"ChannelSelector"),(0,l.kt)("p",null,"ChannelSelector \u7684\u4f5c\u7528\u5c31\u662f\u9009\u51fa Event \u5c06\u8981\u88ab\u53d1\u5f80\u54ea\u4e2a Channel\u3002\u5176\u5171\u6709\u4e24\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u662f Replicating\uff08\u590d\u5236\uff09\u548c Multiplexing\uff08\u591a\u8def\u590d\u7528\uff09\u3002"),(0,l.kt)("p",null,"ReplicatingSelector \u4f1a\u5c06\u540c\u4e00\u4e2a Event \u53d1\u5f80\u6240\u6709\u7684 Channel\uff0cMultiplexingSelector \u4f1a\u6839\u636e\u76f8\u5e94\u7684\u539f\u5219\uff0c\u5c06\u4e0d\u540c\u7684 Event \u53d1\u5f80\u4e0d\u540c\u7684 Channel\u3002"),(0,l.kt)("h4",{id:"sinkprocessor"},"SinkProcessor"),(0,l.kt)("p",null,"SinkProcessor \u5171\u6709\u4e09\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u662f\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"DefaultSinkProcessor\uff1a\u5bf9\u5e94\u7684\u662f\u5355\u4e2a\u7684 Sink\u3002"),(0,l.kt)("li",{parentName:"ul"},"LoadBalancingSinkProcessor\uff1a\u5bf9\u5e94\u7684\u662f Sink Group\uff0c\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u7684\u529f\u80fd\u3002"),(0,l.kt)("li",{parentName:"ul"},"FailoverSinkProcessor\uff1a\u5bf9\u5e94\u7684\u662f Sink Group\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6545\u969c\u6062\u590d\u7684\u529f\u80fd\u3002")),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"33-flume-\u62d3\u6251\u7ed3\u6784"},"3.3 Flume \u62d3\u6251\u7ed3\u6784"),(0,l.kt)("h4",{id:"\u7b80\u5355\u4e32\u8054"},"\u7b80\u5355\u4e32\u8054"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/img_convert/5e336d60c2202a04f90fa45206a96a7a.png",alt:null})),(0,l.kt)("p",null,"\u8fd9\u79cd\u6a21\u5f0f\u662f\u5c06\u591a\u4e2a Flume \u987a\u5e8f\u8fde\u63a5\u8d77\u6765\u4e86\uff0c\u4ece\u6700\u521d\u7684 Source \u5f00\u59cb\u5230\u6700\u7ec8 Sink \u4f20\u9001\u7684\u76ee\u7684\u5b58\u50a8\u7cfb\u7edf\u3002"),(0,l.kt)("p",null,"\u6b64\u6a21\u5f0f\u4e0d\u5efa\u8bae\u6865\u63a5\u8fc7\u591a\u7684 Flume \u6570\u91cf\uff0cFlume \u6570\u91cf\u8fc7\u591a\u4e0d\u4ec5\u4f1a\u5f71\u54cd\u4f20\u8f93\u901f\u7387\uff0c\u800c\u4e14\u4e00\u65e6\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u67d0\u4e2a\u8282\u70b9 Flume \u5b95\u673a\uff0c\u4f1a\u5f71\u54cd\u6574\u4e2a\u4f20\u8f93\u7cfb\u7edf \u3002"),(0,l.kt)("h4",{id:"\u590d\u5236\u548c\u591a\u8def\u590d\u7528"},"\u590d\u5236\u548c\u591a\u8def\u590d\u7528"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/img_convert/229a20a2c6b761e9acde353b97c26cb9.png",alt:null})),(0,l.kt)("p",null,"Flume \u652f\u6301\u5c06\u4e8b\u4ef6\u6d41\u5411\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u76ee\u7684\u5730\u3002\u8fd9\u79cd\u6a21\u5f0f\u53ef\u4ee5\u5c06\u76f8\u540c\u6570\u636e\u590d\u5236\u5230\u591a\u4e2a Channel \u4e2d\uff0c\u6216\u8005\u5c06\u4e0d\u540c\u6570\u636e\u5206\u53d1\u5230\u4e0d\u540c\u7684 Channel \u4e2d\uff0cSink \u53ef\u4ee5\u9009\u62e9\u4f20\u9001\u5230\u4e0d\u540c\u7684\u76ee\u7684\u5730\u3002"),(0,l.kt)("h4",{id:"\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb"},"\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/518579c3c47249eaa4c9bfda9676406c.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,l.kt)("p",null,"Flume \u652f\u6301\u4f7f\u7528\u591a\u4e2a Sink \u903b\u8f91\u4e0a\u5206\u5230\u4e00\u4e2a Sink \u7ec4\uff0cSink \u7ec4\u914d\u5408\u4e0d\u540c\u7684 SinkProcessor \u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u6062\u590d\u7684\u529f\u80fd\u3002"),(0,l.kt)("h4",{id:"\u805a\u5408"},"\u805a\u5408"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/img_convert/2c4f7d96e540544bd51b0e170f43f51d.png",alt:null})),(0,l.kt)("p",null,"\u8fd9\u79cd\u6a21\u5f0f\u662f\u6211\u4eec\u6700\u5e38\u89c1\u7684\uff0c\u4e5f\u975e\u5e38\u5b9e\u7528\uff0c\u65e5\u5e38 Web \u5e94\u7528\u901a\u5e38\u5206\u5e03\u5728\u4e0a\u767e\u4e2a\u670d\u52a1\u5668\uff0c\u5927\u8005\u751a\u81f3\u4e0a\u5343\u4e2a\u3001\u4e0a\u4e07\u4e2a\u670d\u52a1\u5668\u3002\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u5904\u7406\u8d77\u6765\u4e5f\u975e\u5e38\u9ebb\u70e6\u3002"),(0,l.kt)("p",null,"\u7528 Flume \u7684\u8fd9\u79cd\u7ec4\u5408\u65b9\u5f0f\u80fd\u5f88\u597d\u7684\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c\u6bcf\u53f0\u670d\u52a1\u5668\u90fd\u90e8\u7f72\u4e00\u4e2a Flume \u91c7\u96c6\u7cfb\u7edf\uff0c\u4f20\u9001\u5230\u4e00\u4e2a\u96c6\u4e2d\u6536\u96c6\u65e5\u5fd7\u7684 Flume\uff0c\u518d\u7531\u6b64 Flume \u4e0a\u4f20\u81f3 HDFS\u3001Hive\u3001Hbase \u7b49\uff0c\u8fdb\u884c\u65e5\u5fd7\u5206\u6790\u3002"),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"34-flume-\u5f00\u53d1\u6848\u4f8b"},"3.4 Flume \u5f00\u53d1\u6848\u4f8b"),(0,l.kt)("h4",{id:"341-\u590d\u5236\u548c\u591a\u8def\u590d\u7528"},"3.4.1 \u590d\u5236\u548c\u591a\u8def\u590d\u7528"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-4"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume1 \u76d1\u63a7\u6587\u4ef6\u53d8\u52a8\uff0cFlume1 \u5c06\u53d8\u52a8\u5185\u5bb9\u4f20\u9012\u7ed9 Flume2\uff0cFlume2 \u8d1f\u8d23\u5b58\u50a8\u5230 HDFS\u3002\u540c\u65f6 Flume1 \u5c06\u53d8\u52a8\u5185\u5bb9\u4f20\u9012\u7ed9 Flume3\uff0cFlume3 \u8d1f\u8d23\u8f93\u51fa\u5230 Local File System\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-4"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u63a5\u6536\u6587\u4ef6\u7684 Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume1-file-flume.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1 k2\na1.channels = c1 c2\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Memory Channel\na1.channels.c2.type = memory\n\n# Exec Source\na1.sources.r1.selector.type = replicating\na1.sources.r1.channels = c1 c2\na1.sources.r1.type = exec\na1.sources.r1.command = tail -F /opt/flume/input/a.txt\na1.sources.r1.shell = /bin/bash -c\n\n# Avro Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = avro\na1.sinks.k1.hostname = localhost\na1.sinks.k1.port = 4141\n\n# Avro Sink\na1.sinks.k2.channel = c2\na1.sinks.k2.type = avro\na1.sinks.k2.hostname = localhost\na1.sinks.k2.port = 4142\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u8f93\u5165\u5230 HDFS \u7684 Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume2-flume-hdfs.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4141\n\n# HDFS Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = hdfs\na1.sinks.k1.hdfs.path = hdfs://node6:9000/flume/%Y-%m-%d/%H\na1.sinks.k1.hdfs.round = true\na1.sinks.k1.hdfs.roundValue = 1\na1.sinks.k1.hdfs.fileType = DataStream\na1.sinks.k1.hdfs.useLocalTimeStamp = true\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u8f93\u51fa\u5230\u672c\u5730\u76ee\u5f55\u7684 Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume3-flume-dir.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4142\n\n# File Roll Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = file_roll\na1.sinks.k1.sink.directory = /opt/flume/output\n")),(0,l.kt)("p",{parentName:"li"},"\u6ce8\u610f\uff1a\u8f93\u51fa\u7684\u76ee\u5f55\u5fc5\u987b\u6570\u5df2\u7ecf\u5b58\u5728\u7684\u76ee\u5f55\uff0c\u5982\u679c\u8be5\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u5e76\u4e0d\u4f1a\u81ea\u52a8\u521b\u5efa\u76ee\u5f55\u3002"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p /opt/flume/output\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u6309\u987a\u5e8f\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent -c conf/ -f jobs/flume3-flume-dir.conf -n a1\n\nbin/flume-ng agent -c conf/ -f jobs/flume2-flume-hdfs.conf -n a1\n\nbin/flume-ng agent -c conf/ -f jobs/flume1-file-flume.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5199\u5165\u6587\u4ef6"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo $RANDOM >> /opt/flume/input/a.txt\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u67e5\u770b HDFS \u548c\u672c\u5730\u76ee\u5f55"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"watch ls /opt/flume/output\n")))),(0,l.kt)("h4",{id:"342-\u8d1f\u8d23\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb"},"3.4.2 \u8d1f\u8d23\u5747\u8861\u548c\u6545\u969c\u8f6c\u79fb"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-5"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume1 \u76d1\u63a7\u4e00\u4e2a\u7aef\u53e3\uff0c\u5176 Sink \u7ec4\u4e2d\u7684 Sink \u5206\u522b\u5bf9\u63a5 Flume2 \u548c Flume3\uff0c\u91c7\u7528 FailoverSinkProcessor \u5b9e\u73b0\u6545\u969c\u8f6c\u79fb\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-5"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u63a5\u6536\u7aef\u53e3\u6570\u636e\u7684 Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume1-netcat-flume.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinkgroups = g1\na1.sinks = k1 k2\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# NetCat TCP Source\na1.sources.r1.channels = c1\na1.sources.r1.type = netcat\na1.sources.r1.bind = localhost\na1.sources.r1.port = 44444\n\n# Sink Group\na1.sinkgroups.g1.sinks = k1 k2\na1.sinkgroups.g1.processor.type = failover\na1.sinkgroups.g1.processor.priority.k1 = 5\na1.sinkgroups.g1.processor.priority.k2 = 10\na1.sinkgroups.g1.processor.maxpenalty = 10000\n\n# Avro Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = avro\na1.sinks.k1.hostname = localhost\na1.sinks.k1.port = 4141\n\n# Avro Sink\na1.sinks.k2.channel = c1\na1.sinks.k2.type = avro\na1.sinks.k2.hostname = localhost\na1.sinks.k2.port = 4142\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e24\u4e2a\u8f93\u51fa\u5230\u672c\u5730\u63a7\u5236\u53f0\u7684 Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume2-flume-console.conf"),"\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume3-flume-console.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4141\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4142\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u987a\u5e8f\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"bin/flume-ng agent -c conf/ -f jobs/flume2-flume-console.conf -n a1 -Dflume.root.logger=INFO,console\n\nbin/flume-ng agent -c conf/ -f jobs/flume3-flume-console.conf -n a1 -Dflume.root.logger=INFO,console\n\nbin/flume-ng agent -c conf/ -f jobs/flume1-netcat-flume.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5411\u672c\u673a\u7aef\u53e3\u53d1\u9001\u6570\u636e"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"nc loclahost 44444\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u67e5\u770b Flume2 \u53ca Flume3 \u63a7\u5236\u53f0\u65e5\u5fd7\u6253\u5370\u60c5\u51b5")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u505c\u6b62 Flume2 \u67e5\u770b Flume3 \u63a7\u5236\u53f0\u65e5\u5fd7\u6253\u5370\u60c5\u51b5"))),(0,l.kt)("h4",{id:"343-\u805a\u5408"},"3.4.3 \u805a\u5408"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-6"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Flume1 \u76d1\u63a7\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"li"},"/opt/flume/input/a.txt")),(0,l.kt)("li",{parentName:"ul"},"Flume2 \u76d1\u63a7\u7aef\u53e3 44444"),(0,l.kt)("li",{parentName:"ul"},"Flume1 \u4e0e Flume2 \u5c06\u6570\u636e\u53d1\u9001\u7ed9 Flume3\uff0cFlume3 \u5c06\u6700\u7ec8\u6570\u636e\u6253\u5370\u5230\u63a7\u5236\u53f0")),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-6"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u76d1\u63a7\u6587\u4ef6\u7684 Flume1 \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume1-file-flume.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Exec Source\na1.sources.r1.channels = c1\na1.sources.r1.type = exec\na1.sources.r1.command = tail -F /opt/flume/input/a.txt\na1.sources.r1.shell = /bin/bash -c\n\n# Avro Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = avro\na1.sinks.k1.hostname = localhost\na1.sinsk.k1.port = 4141\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hadoop102 \u4e0a\u76d1\u63a7\u7aef\u53e3\u6570\u636e\u7684 Flume2 \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume2-netcat-flume.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# NetCat TCP Source\na1.sources.r1.channels = c1\na1.sources.r1.type = netcat\na1.sources.r1.bind = localhost\na1.sources.r1.port = 44444\n\n# Avro Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = avro\na1.sinks.k1.hostname = localhost\na1.sinsk.k1.port = 4141\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Hadoop103 \u4e0a\u805a\u5408\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u7684 Flume3 \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"jobs/flume3-flume-logger.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = arvo\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4141\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# Flume3\nbin/flume-ng agent -c conf/ -f jobs/flume3-flume-logger.conf -n a1 -Dflume.root.logger=INFO,console\n\n# Flume2\nbin/flume-ng agent -c conf/ -f jobs/flume2-netcat-flume.conf -n a1\n\n# Flume1\nbin/flume-ng agent -c conf/ -f jobs/flume1-file-flume.conf -n a1\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u8ffd\u52a0\u6587\u4ef6\u5e76\u5411\u7aef\u53e3\u53d1\u9001\u6570\u636e"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"# Flume1\necho $RANDOM >> /opt/flume/input/a.txt\n\n# Flume1\nnc localhost 44444\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u67e5\u770b Flume3 \u63a7\u5236\u53f0\u6253\u5370\u60c5\u51b5"))),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"35-\u81ea\u5b9a\u4e49-interceptor"},"3.5 \u81ea\u5b9a\u4e49 Interceptor"),(0,l.kt)("h5",{id:"\u6848\u4f8b\u9700\u6c42-7"},"\u6848\u4f8b\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u91c7\u96c6\u670d\u52a1\u5668\u672c\u5730\u65e5\u5fd7\uff0c\u9700\u8981\u6309\u7167\u65e5\u5fd7\u7c7b\u578b\u7684\u4e0d\u540c\uff0c\u5c06\u4e0d\u540c\u7684\u65e5\u5fd7\u53d1\u5f80\u4e0d\u540c\u7684\u5206\u6790\u7cfb\u7edf\u3002"),(0,l.kt)("h5",{id:"\u9700\u6c42\u5206\u6790"},"\u9700\u6c42\u5206\u6790"),(0,l.kt)("p",null,"\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\uff0c\u4e00\u53f0\u670d\u52a1\u5668\u4ea7\u751f\u7684\u65e5\u5fd7\u7c7b\u578b\u53ef\u80fd\u6709\u5f88\u591a\u79cd\uff0c\u4e0d\u540c\u7c7b\u578b\u7684\u65e5\u5fd7\u53ef\u80fd\u9700\u8981\u53d1\u9001\u5230\u4e0d\u540c\u7684\u5206\u6790\u7cfb\u7edf\u3002"),(0,l.kt)("p",null,"\u6b64\u65f6\u4f1a\u7528\u5230 Flume \u62d3\u6251\u7ed3\u6784\u4e2d\u7684 Multiplexing \u7ed3\u6784\uff0cMultiplexing \u7684\u539f\u7406\u662f\uff1a\u6839\u636e Event \u4e2d Header \u7684\u67d0\u4e2a Key \u7684\u503c\uff0c\u5c06\u4e0d\u540c\u7684 Event \u53d1\u9001\u5230\u4e0d\u540c\u7684 Channel\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a Interceptor\uff0c\u4e3a\u4e0d\u540c\u7c7b\u578b\u7684 Event \u7684 Header \u7684 Key \u8d4b\u4e88\u4e0d\u540c\u7684\u503c\u3002"),(0,l.kt)("h5",{id:"\u5b9e\u73b0\u6b65\u9aa4-7"},"\u5b9e\u73b0\u6b65\u9aa4"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa Maven \u9879\u76ee\u5e76\u5f15\u5165\u4f9d\u8d56"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n  <groupId>org.apache.flume</groupId>\n  <artifactId>flume-ng-core</artifactId>\n  <version>1.9.0</version>\n</dependency>\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u81ea\u5b9a\u4e49 Interceptor \u5e76\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Interceptor")," \u63a5\u53e3"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'import org.apache.flume.Context;\nimport org.apache.flume.Event;\nimport org.apache.flume.interceptor.Interceptor;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Map;\n\npublic class MyInterceptor implements Interceptor {\n    private List<Event> eventList;\n\n    @Override\n    public void initialize() {\n        eventList = new ArrayList<>();\n    }\n\n    // \u5355\u4e2a\u4e8b\u4ef6\u62e6\u622a\n    @Override\n    public Event intercept(Event event) {\n        Map<String, String> headers = event.getHeaders();\n        String body = new String(event.getBody());\n        if (body.contains("info")) {\n            headers.put("type", "info");\n        } else if (body.contains("error")) {\n            headers.put("type", "error");\n        }\n        return event;\n    }\n\n    // \u6279\u91cf\u4e8b\u4ef6\u62e6\u622a\n    @Override\n    public List<Event> intercept(List<Event> events) {\n        eventList.clear();\n        for (Event event : events) {\n            eventList.add(intercept(event));\n        }\n        return eventList;\n    }\n\n    @Override\n    public void close() { }\n\n    public static class Builder implements Interceptor.Builder {\n        @Override\n        public Interceptor build() {\n            return new MyInterceptor();\n        }\n\n        @Override\n        public void configure(Context context) { }\n    }\n}\n'))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"flume1-netcat-flume.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1 k2\na1.channels = c1 c2\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Memory Channel\na1.channels.c2.type = memory\n\n# NetCat TCP Source\na1.sources.r1.channels = c1 c2\na1.sources.r1.type = netcat\na1.sources.r1.bind = localhost\na1.sources.r1.port = 44444\na1.sources.r1.interceptors = i1\na1.sources.r1.interceptors.i1.type = xyz.icefery.demo.interceptor.MyInterceptor$Builder\na1.sources.r1.selector.type = multiplexing\na1.sources.r1.selector.header = type\na1.sources.r1.selector.mapping.info = c1\na1.sources.r1.selector.mapping.error = c2\n\n# Avro Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = avro\na1.sinks.k1.hostname = localhost\na1.sinks.k1.port = 4141\n\n# Avro Sink\na1.sinks.k2.channel = c2\na1.sinks.k2.type = avro\na1.sinks.k2.hostname = localhost\na1.sinks.k2.port = 4142\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"flume2-flume-logger.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4141\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Flume \u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"flume3-flume-logger.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Avro Source\na1.sources.r1.channels = c1\na1.sources.r1.type = avro\na1.sources.r1.bind = localhost\na1.sources.r1.port = 4142\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u542f\u52a8\u4efb\u52a1 Flume2\u3001Flume3\u3001Flume1")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5411\u7aef\u53e3\u53d1\u9001\u6570\u636e"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo 'info' | nc localhost 44444\n")))),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"36-\u81ea\u5b9a\u4e49-source"},"3.6 \u81ea\u5b9a\u4e49 Source"),(0,l.kt)("h5",{id:"\u4ecb\u7ecd-1"},"\u4ecb\u7ecd"),(0,l.kt)("p",null,"Source \u662f\u8d1f\u8d23\u63a5\u6536\u6570\u636e\u5230 Flume Agent \u7684\u7ec4\u4ef6\u3002Source \u7ec4\u4ef6\u53ef\u4ee5\u5904\u7406\u5404\u79cd\u7c7b\u578b\u3001\u5404\u79cd\u683c\u5f0f\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u5305\u62ec Avro\u3001Thrift\u3001Exec\u3001JMS\u3001Spooling Directory\u3001NetCat\u3001Sequence Generator\u3001Syslog\u3001HTTP\u3001Legacy\u3002"),(0,l.kt)("p",null,"\u5b98\u65b9\u63d0\u4f9b\u7684 Source \u7c7b\u578b\u5df2\u7ecf\u5f88\u591a\uff0c\u4f46\u662f\u6709\u65f6\u5019\u5e76\u4e0d\u80fd\u6ee1\u8db3\u5b9e\u9645\u5f00\u53d1\u5f53\u4e2d\u7684\u9700\u6c42\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u9700\u8981\u6839\u636e\u5b9e\u9645\u9700\u6c42\u81ea\u5b9a\u4e49\u67d0\u4e9b Source\u3002"),(0,l.kt)("h5",{id:"\u9700\u6c42"},"\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u63a5\u6536\u6570\u636e\uff0c\u5e76\u7ed9\u6bcf\u6761\u6570\u636e\u6dfb\u52a0\u524d\u7f00\uff0c\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002\u524d\u7f00\u8bfe\u4ece Flume \u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u3002"),(0,l.kt)("h5",{id:"\u7f16\u7801"},"\u7f16\u7801"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u81ea\u5b9a\u4e49 Source\uff0c\u7ee7\u627f ",(0,l.kt)("inlineCode",{parentName:"p"},"AbstractSource")," \u7c7b\uff0c\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Configurable")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"PollableSource")," \u63a5\u53e3"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class MySource extends AbstractSource implements Configurable, PollableSource {\n    private Long delay;\n    private String field;\n\n    @Override\n    public void configure(Context context) {\n        delay = context.getLong("delay");\n        field = context.getString("field");\n    }\n\n    @Override\n    public Status process() throws EventDeliveryException {\n        try {\n            Map<String, String> headers = new HashMap<>();\n            Event event = new SimpleEvent();\n            for (int i = 0; i < 5; i++) {\n                event.setHeaders(headers);\n                event.setBody((field + i).getBytes());\n                getChannelProcessor().processEvent(event);\n                TimeUnit.MILLISECONDS.sleep(delay);\n            }\n            return Status.READY;\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n            return Status.BACKOFF;\n        }\n    }\n\n    @Override\n    public long getBackOffSleepIncrement() {\n        return 0;\n    }\n\n    @Override\n    public long getMaxBackOffSleepInterval() {\n        return 0;\n    }\n}\n')),(0,l.kt)("p",{parentName:"li"},"\u6253\u5305\u5e76\u4e0a\u4f20\u81f3 Flume \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"lib")," \u76ee\u5f55\u4e0b\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"flume-custom-logger.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# Custom Source\na1.sources.r1.channels = c1\na1.sources.r1.type = xyz.icefery.demo.source.MySource\na1.sources.r1.prefix = custom-\n\n# Logger Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = logger\n")))),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"37-\u81ea\u5b9a\u4e49-sink"},"3.7 \u81ea\u5b9a\u4e49 Sink"),(0,l.kt)("h5",{id:"\u4ecb\u7ecd-2"},"\u4ecb\u7ecd"),(0,l.kt)("p",null,"Sink \u4e0d\u65ad\u5730\u8f6e\u8be2 Channel \u4e2d\u7684\u4e8b\u4ef6\u4e14\u6279\u91cf\u5730\u79fb\u9664\u5b83\u4eec\uff0c\u5e76\u5c06\u8fd9\u4e9b\u4e8b\u4ef6\u6279\u91cf\u5199\u5165\u5230\u5b58\u50a8\u6216\u7d22\u5f15\u7cfb\u7edf\u3001\u6216\u8005\u88ab\u53d1\u9001\u5230\u53e6\u4e00\u4e2a Flume Agent\u3002"),(0,l.kt)("p",null,"Sink \u662f\u5b8c\u5168\u4e8b\u52a1\u6027\u7684\uff0c\u5728\u4ece Channel \u6279\u91cf\u5220\u9664\u6570\u636e\u4e4b\u524d\uff0c\u6bcf\u4e2a Sink \u7528 Channel \u542f\u52a8\u4e00\u4e2a\u4e8b\u52a1\u3002\u6279\u91cf\u4e8b\u4ef6\u4e00\u65e6\u6210\u529f\u5199\u51fa\u5230\u5b58\u50a8\u7cfb\u7edf\u6216\u4e0b\u4e00\u4e2a Flume Agent\uff0cSink \u5c31\u5229\u7528 Channel \u63d0\u4ea4\u4e8b\u52a1\u3002\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u8be5 Channel \u4ece\u81ea\u5df1\u7684\u5185\u90e8\u7f13\u51b2\u533a\u5220\u9664\u4e8b\u4ef6\u3002"),(0,l.kt)("p",null,"Sink \u7ec4\u4ef6\u76ee\u7684\u5730\u5305\u62ec HDFS\u3001Avro\u3001Thrift\u3001IPC\u3001File\u3001Null\u3001HBase\u3001Solr\u3001\u81ea\u5b9a\u4e49\u3002\u5b98\u65b9\u63d0\u4f9b\u7684 Sink \u7c7b\u578b\u5df2\u7ecf\u5f88\u591a\uff0c\u4f46\u662f\u6709\u65f6\u5019\u5e76\u4e0d\u80fd\u6ee1\u8db3\u5b9e\u9645\u5f00\u53d1\u5f53\u4e2d\u7684\u9700\u6c42\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u9700\u8981\u6839\u636e\u5b9e\u9645\u9700\u6c42\u81ea\u5b9a\u4e49\u67d0\u4e9b Sink\u3002"),(0,l.kt)("h5",{id:"\u9700\u6c42-1"},"\u9700\u6c42"),(0,l.kt)("p",null,"\u4f7f\u7528 Flume \u63a5\u6536\u6570\u636e\uff0c\u5e76\u5728 Sink \u7aef\u7ed9\u6bcf\u6761\u6570\u636e\u5929\u6dfb\u52a0\u524d\u7f00\u548c\u540e\u7f00\uff0c\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002\u524d\u540e\u7f00\u53ef\u5728 Flume \u4efb\u52a1\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u3002"),(0,l.kt)("h5",{id:"\u7f16\u7801-1"},"\u7f16\u7801"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u81ea\u5b9a\u4e49 Sink\uff0c\u7ee7\u627f ",(0,l.kt)("inlineCode",{parentName:"p"},"AbstractSink"),"\uff0c\u5b9e\u73b0 ",(0,l.kt)("inlineCode",{parentName:"p"},"Configurable")," \u63a5\u53e3"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-java"},'import org.apache.flume.Channel;\nimport org.apache.flume.Context;\nimport org.apache.flume.Event;\nimport org.apache.flume.EventDeliveryException;\nimport org.apache.flume.Transaction;\nimport org.apache.flume.conf.Configurable;\nimport org.apache.flume.sink.AbstractSink;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\npublic class MySink extends AbstractSink implements Configurable {\n    private static final Logger log = LoggerFactory.getLogger(AbstractSink.class);\n\n    private String prefix;\n    private String suffix;\n\n    @Override\n    public void configure(Context context) {\n        prefix = context.getString("prefix");\n        suffix = context.getString("suffix");\n    }\n\n    @Override\n    public Status process() throws EventDeliveryException {\n        Channel channel = getChannel();\n        Transaction tx = channel.getTransaction();\n        tx.begin();\n        // \u8bfb\u53d6 Channel \u4e2d\u7684\u4e8b\u4ef6\n        Event event;\n        while (true) {\n            event = channel.take();\n            if (event != null) {\n                break;\n            }\n        }\n        // \u5904\u7406\u4e8b\u4ef6\n        Status status;\n        try {\n            log.info(prefix + new String(event.getBody()) + suffix);\n            tx.commit();\n            status = Status.READY;\n        } catch (Exception e) {\n            tx.rollback();\n            status = Status.BACKOFF;\n        } finally {\n            tx.close();\n        }\n        return status;\n    }\n}\n')),(0,l.kt)("p",{parentName:"li"},"\u6253\u5305\u4e0a\u4f20\u81f3 Flume \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"lib")," \u76ee\u5f55\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u914d\u7f6e\u6587\u4ef6 ",(0,l.kt)("inlineCode",{parentName:"p"},"flume-netcat-custom.conf")),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-properties"},"# Agent\na1.sources = r1\na1.sinks = k1\na1.channels = c1\n\n# Memory Channel\na1.channels.c1.type = memory\n\n# NetCat TCP Source\na1.sources.r1.channels = c1\na1.sources.r1.type = netcat\na1.sources.r1.bind = localhost\na1.sources.r1.port = 44444\n\n# Custom Sink\na1.sinks.k1.channel = c1\na1.sinks.k1.type = xyz.icefery.demo.sink.MySink\na1.sinks.k1.prefix = custom-\na1.sinks.k1.suffix = -custom\n")))),(0,l.kt)("br",null),(0,l.kt)("br",null),(0,l.kt)("h2",{id:"\u56db\u9762\u8bd5\u9898"},"\u56db\u3001\u9762\u8bd5\u9898"),(0,l.kt)("h3",{id:"41-\u4f60\u662f\u5982\u4f55\u5b9e\u73b0-flume-\u6570\u636e\u4f20\u8f93\u7684\u76d1\u63a7\u7684"},"4.1 \u4f60\u662f\u5982\u4f55\u5b9e\u73b0 Flume \u6570\u636e\u4f20\u8f93\u7684\u76d1\u63a7\u7684\uff1f"),(0,l.kt)("p",null,"\u4f7f\u7528\u7b2c\u4e09\u65b9\u6846\u67b6 Ganglia \u5b9e\u65f6\u76d1\u63a7 Flume\u3002"),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"42-flume-\u7684-sourcesinkchannel-\u7684\u4f5c\u7528\u4f60\u4eec-source-\u662f\u4ec0\u4e48\u7c7b\u578b"},"4.2 Flume \u7684 Source\u3001Sink\u3001Channel \u7684\u4f5c\u7528\uff1f\u4f60\u4eec Source \u662f\u4ec0\u4e48\u7c7b\u578b\uff1f"),(0,l.kt)("h4",{id:"\u4f5c\u7528"},"\u4f5c\u7528"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Source \u7ec4\u4ef6\u662f\u4e13\u95e8\u7528\u6765\u6536\u96c6\u6570\u636e\u7684\uff0c\u53ef\u4ee5\u5904\u7406\u5404\u79cd\u7c7b\u578b\u3001\u5404\u79cd\u683c\u5f0f\u7684\u65e5\u5fd7\u6570\u636e\uff0c\u5305\u62ec Avro\u3001Thrift\u3001Exec\u3001JMS\u3001Spooling Directory\u3001NetCat\u3001Sequence Generator\u3001Syslog\u3001HTTP\u3001Legacy\u3002"),(0,l.kt)("li",{parentName:"ul"},"Sink \u7ec4\u4ef6\u662f\u7528\u4e8e\u628a\u6570\u636e\u53d1\u9001\u5230\u76ee\u7684\u5730\u7684\u7ec4\u4ef6\uff0c\u76ee\u7684\u5730\u5305\u62ec HDFS\u3001Logger\u3001Avro\u3001Thrift\u3001IPC\u3001File\u3001HBase\u3001Solor\u3001\u81ea\u5b9a\u4e49\u3002"),(0,l.kt)("li",{parentName:"ul"},"Channel \u7ec4\u4ef6\u5bf9\u91c7\u96c6\u5230\u7684\u6570\u636e\u8fdb\u884c\u7f13\u5b58\uff0c\u53ef\u4ee5\u5b58\u653e\u5728 Memory \u6216\u5728 File \u4e2d\u3002")),(0,l.kt)("h4",{id:"source-\u7c7b\u578b"},"Source \u7c7b\u578b"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u76d1\u63a7\u540e\u53f0\u65e5\u5fd7\uff1aExec"),(0,l.kt)("li",{parentName:"ul"},"\u76d1\u63a7\u540e\u53f0\u4ea7\u751f\u65e5\u5fd7\u7684\u7aef\u53e3\uff1aNetCat")),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"43-flume-\u7684-channel-selectors"},"4.3 Flume \u7684 Channel Selectors"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/ac6c4ce21fe843c0b5467b854eb5fff3.png",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,l.kt)("h3",{id:"44-flume-\u53c2\u6570\u8c03\u4f18"},"4.4 Flume \u53c2\u6570\u8c03\u4f18"),(0,l.kt)("h4",{id:"source-1"},"Source"),(0,l.kt)("p",null,"\u589e\u52a0 Source \u4e2a\u6570\u53ef\u4ee5\u589e\u52a0 Source \u8bfb\u53d6\u6570\u636e\u7684\u80fd\u529b\uff08\u4f7f\u7528 Taildir Source \u65f6\u53ef\u589e\u52a0 FileGroup \u4e2a\u6570\uff09\u3002\u4f8b\u5982\uff1a\u5f53\u4e00\u4e2a\u76ee\u5f55\u4ea7\u751f\u7684\u6587\u4ef6\u8fc7\u591a\u65f6\u9700\u8981\u5c06\u8fd9\u4e2a\u6587\u4ef6\u76ee\u5f55\u62c6\u5206\u6210\u591a\u4e2a\u6587\u4ef6\u76ee\u5f55\uff0c\u540c\u65f6\u914d\u7f6e\u597d\u591a\u4e2a Source \u4ee5\u4fdd\u8bc1 Source \u6709\u8db3\u591f\u7684\u80fd\u529b\u83b7\u53d6\u5230\u65b0\u4ea7\u751f\u7684\u6570\u636e\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"batchSize"),"\u53c2\u6570\u51b3\u5b9a Source \u4e00\u6b21\u6279\u91cf\u8fd0\u8f93\u5230 Channel \u7684 Event \u6761\u6570\uff0c\u9002\u5f53\u8c03\u5927\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u63d0\u9ad8 Source \u642c\u8fd0 Event \u5230 Channel \u65f6\u7684\u6027\u80fd\u3002"),(0,l.kt)("h4",{id:"channel-1"},"Channel"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"type")," \u9009\u62e9 ",(0,l.kt)("inlineCode",{parentName:"p"},"memory")," \u65f6 Channel \u7684\u6027\u80fd\u6700\u597d\uff0c\u4f46\u662f\u5982\u679c Flume \u8fdb\u7a0b\u610f\u5916\u6302\u6389\u53ef\u80fd\u4f1a\u4e22\u5931\u6570\u636e\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"type")," \u9009\u62e9 ",(0,l.kt)("inlineCode",{parentName:"p"},"file"),"\u65f6 Channel \u7684\u5bb9\u9519\u6027\u66f4\u597d\uff0c\u4f46\u662f\u6027\u80fd\u4f1a\u6bd4 Memory Channel \u5dee\u3002"),(0,l.kt)("p",null,"\u4f7f\u7528 File Channel \u65f6 ",(0,l.kt)("inlineCode",{parentName:"p"},"dataDirs")," \u914d\u7f6e\u591a\u4e2a\u4e0d\u540c\u76d8\u4e0b\u7684\u76ee\u5f55\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"capacity")," \u53c2\u6570\u51b3\u5b9a Channel \u53ef\u5bb9\u7eb3\u6700\u5927\u7684 Event \u6761\u6570\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"transactionCapacity")," \u53c2\u6570\u51b3\u5b9a\u6bcf\u6b21 Source \u5f80 Channel \u91cc\u9762\u5199\u7684\u6700\u5927 Event \u6761\u6570\u548c\u6bcf\u6b21 Sink \u4ece Channel \u91cc\u9762\u8bfb\u7684\u6700\u5927\u7684 Event \u6761\u6570\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"transactionCapacity")," \u9700\u8981\u5927\u4e8e Source \u548c Sink \u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"batchSize")," \u53c2\u6570\u3002"),(0,l.kt)("h4",{id:"sink-1"},"Sink"),(0,l.kt)("p",null,"\u589e\u52a0 Sink \u7684\u4e2a\u6570\u53ef\u4ee5\u589e\u52a0 Sink \u6d88\u8d39 Event \u7684\u80fd\u529b\u3002Sink \u4e5f\u4e0d\u662f\u8d8a\u591a\u8d8a\u597d\uff0c\u591f\u7528\u5c31\u884c\uff0c\u8fc7\u591a\u7684 Sink \u4f1a\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\uff0c\u9020\u6210\u7cfb\u7edf\u8d44\u6e90\u4e0d\u5fc5\u8981\u7684\u6d6a\u8d39\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"batchSize")," \u53c2\u6570\u51b3\u5b9a Sink \u4e00\u6b21\u6279\u91cf\u4ece Channel \u8bfb\u53d6\u7684 Event \u6761\u6570\uff0c\u9002\u5f53\u8c03\u5927\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u63d0\u9ad8 Sink \u4ece Channel \u642c\u51fa Event \u7684\u6027\u80fd\u3002"),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"45-flume-\u7684\u4e8b\u52a1\u673a\u5236"},"4.5 Flume \u7684\u4e8b\u52a1\u673a\u5236"),(0,l.kt)("p",null,"Flume \u4f7f\u7528\u4e24\u4e2a\u72ec\u7acb\u7684\u4e8b\u52a1\u5206\u522b\u8d1f\u8d23\u4ece Source \u5230 Channel\uff0c\u4ee5\u53ca\u4ece Channel \u5230 Sink \u7684\u4e8b\u4ef6\u4f20\u9012\u3002"),(0,l.kt)("p",null,"\u6bd4\u5982 Spooling Directory Source \u4e3a\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u521b\u5efa\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u4e00\u65e6\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u4e8b\u4ef6\u5168\u90e8\u4f20\u9012\u5230 Channel \u4e14\u63d0\u4ea4\u6210\u529f\uff0c\u90a3\u4e48 Source \u5c31\u5c06\u8be5\u6587\u4ef6\u6807\u8bb0\u4e3a\u5b8c\u6210\u3002"),(0,l.kt)("p",null,"\u540c\u7406\uff0c\u4e8b\u52a1\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u5904\u7406 Channel \u5230 Sink \u7684\u4f20\u9012\u8fc7\u7a0b\uff0c\u5982\u679c\u56e0\u4e3a\u67d0\u79cd\u539f\u56e0\u4f7f\u5f97\u4e8b\u4ef6\u65e0\u6cd5\u8bb0\u5f55\uff0c\u90a3\u4e48\u4e8b\u52a1\u5c06\u4f1a\u56de\u6eda\u3002\u4e14\u6240\u6709\u7684\u4e8b\u4ef6\u90fd\u4f1a\u4fdd\u6301\u5230 Channel \u4e2d\uff0c\u7b49\u5f85\u91cd\u65b0\u4f20\u9012\u3002"),(0,l.kt)("br",null),(0,l.kt)("h3",{id:"46-flume-\u91c7\u96c6\u6570\u636e\u4f1a\u4e22\u5931\u5417"},"4.6 Flume \u91c7\u96c6\u6570\u636e\u4f1a\u4e22\u5931\u5417\uff1f"),(0,l.kt)("p",null,"\u6839\u636e Flume \u7684\u67b6\u6784\u539f\u7406\uff0cFlume \u662f\u4e0d\u53ef\u80fd\u4e22\u5931\u6570\u636e\u7684\uff0c\u5176\u5185\u90e8\u6709\u5b8c\u5584\u7684\u4e8b\u52a1\u673a\u5236\uff0c Source \u5230 Channel \u662f\u4e8b\u52a1\u6027\u7684\uff0cChannel \u5230 Sink \u662f\u4e8b\u52a1\u6027\u7684\uff0c\u56e0\u6b64\u8fd9\u4e24\u4e2a\u73af\u8282\u4e0d\u4f1a\u51fa\u73b0\u6570\u636e\u7684\u4e22\u5931\uff0c\u552f\u4e00\u53ef\u80fd\u4e22\u5931\u6570\u636e\u7684\u60c5\u51b5\u662f Channel \u91c7\u7528 Memory Channel\uff0cAgent \u5b95\u673a\u5bfc\u81f4\u6570\u636e\u4e22\u5931\uff0c\u6216\u8005 Channel \u5b58\u50a8\u6570\u636e\u5df2\u6ee1\uff0c\u5bfc\u81f4 Source \u4e0d\u518d\u5199\u5165\uff0c\u672a\u5199\u5165\u7684\u6570\u636e\u4e22\u5931\u3002"),(0,l.kt)("p",null,"Flume \u4e0d\u4f1a\u4e22\u5931\u6570\u636e\uff0c\u4f46\u662f\u6709\u53ef\u80fd\u9020\u6210\u6570\u636e\u7684\u91cd\u590d\uff0c\u4f8b\u5982\u6570\u636e\u5df2\u7ecf\u7531 Sink \u53d1\u51fa\uff0c\u4f46\u662f\u6ca1\u6709\u63a5\u6536\u5230\u54cd\u5e94\uff0cSink \u4f1a\u518d\u6b21\u53d1\u9001\u6570\u636e\uff0c\u6b64\u65f6\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u7684\u91cd\u590d\u3002"))}c.isMDXComponent=!0}}]);